<!DOCTYPE html>
<html lang="zh-cmn-Hant"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>bschen</title>
    <base href="https://bschen.tw/">
    <link rel="stylesheet" href="/css/tachyons.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
</head>
<body><header class="mw7 mw7-ns mv4 ph5 ph5-ns center">
    <nav class="pv2 pv2-ns ph3 ph3-ns bg-dark-blue">
        
        <a class="link dim near-white f6 f5-ns dib mr3" href="/">/Home</a>
        
        <a class="link dim near-white f6 f5-ns dib mr3" href="/posts">/Posts</a>
        
    </nav>
</header>
<div class="mw7 mw7-ns mv4 ph5 ph5-ns center">
<main>
    <h1 class="lh-title tc pa1 mb0">An AES Encryption Implementation in PHP</h1>
    <h2 class="f4 tc mb4"><time>2016-06-01</time></h2>
    <section class="lh-copy">
        <p>雖然網路上找到的大部份程式碼都是用 <a href="http://php.net/manual/en/book.mcrypt.php">Mcrypt 模組</a>實作的範例，不過用 <a href="http://php.net/manual/en/book.openssl.php">OpenSSL 模組</a>來實作的話會更簡潔明瞭：</p>

<script src="https://gist.github.com/gundamew/3462de49997eeb1fe34753d6c27f7646.js"></script>

<p>用 Mcrypt 實作的範例：</p>

<script src="https://gist.github.com/gundamew/2f3705db4c421f1ddd2655a72697abc4.js"></script>

<p>實作時還發生了一個小烏龍：由於跟別人事先約定好要用 AES 128 加密，可是共用的密鑰長度卻是 32 個字元（256 bits），讓我在用 <code>AES-128-CBC</code> 測試時一直沒辦法解密出正確的原文，之後心血來潮改用 <code>AES-256-CBC</code> 測試後就成功解密了。找資料時看到<a href="http://stackoverflow.com/a/4413290/6404056">別人遇到的類似狀況</a>，我才確定問題出在密鑰的長度上</p>

<ul>
<li><a href="https://www.urbaninsight.com/2012/06/13/encrypt-and-decrypt-strings-php">Encrypt and decrypt strings in PHP | Urban Insight</a></li>
<li><a href="http://thefsb.tumblr.com/post/110749271235/using-opensslendecrypt-in-php-instead-of">Using openssl_en/decrypt() in PHP instead of&hellip;</a></li>
<li><a href="http://security.stackexchange.com/a/90850">initialisation vector - Encrypting using AES-256, can I use 256 bits IV? - Information Security Stack Exchange</a></li>
<li><a href="http://ijecorp.blogspot.tw/2013/08/python-m2crypto-aes-encrypt-decrypt.html">寫程式是良心事業: Python M2Crypto - AES 的 Encrypt 與 Decrypt</a></li>
</ul>

    </section>
</main>

        </div><hr class="w-50">
<footer class="mw7 mw7-ns mb4 ph5 ph5-ns center">
    <div class="mt4">
        <span class="f6 db tc">Powered by <a href="https://gohugo.io/" target="_blank" class="link dim dark-blue fw6">Hugo</a></span>
    </div>
</footer>
</body>
</html>

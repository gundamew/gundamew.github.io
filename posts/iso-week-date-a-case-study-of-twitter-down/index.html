<!DOCTYPE html>
<html lang="zh-cmn-Hant">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ISO Week Date: A Case Study of Twitter Down | bschen</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="http://bschen.tw/css/theme-override.css">
    <header>

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <nav>
    <ul>
      
      
      <li class="pull-left ">
        <a href="http://bschen.tw/">/home/bschen</a>
      </li>
      

      

    </ul>
  </nav>
</header>

  </head>

  <body>
    <br/>

<div class="article-meta">
<h1><span class="title">ISO Week Date: A Case Study of Twitter Down</span></h1>

<h2 class="date">2014/12/29</h2>
<p class="terms">
  
  
  
  
  
</p>
</div>



<main>


<p>由於<strong>本週四</strong>就是 2015 年的元旦了，所以用 <a href="https://en.wikipedia.org/wiki/ISO_week_date">ISO week date</a> 記錄時間的系統，會從<strong>週一</strong>開始進入 2015 年，即使週一的日期是 2014-12-29 才對</p>

<p>摘自 Wikipedia 的說明：</p>

<blockquote>
<p>The first week of the year, hence, always <a href="https://en.wikipedia.org/wiki/ISO_week_date#First_week">contains 4 January</a>. ISO week <a href="https://en.wikipedia.org/wiki/Year_numbering">year numbering</a> therefore slightly deviates from the Gregorian for some days close to 1 January.</p>
</blockquote>

<p>關於 PHP <a href="http://php.net/manual/en/function.date.php"><code>date('o')</code></a> 的說明：</p>

<blockquote>
<p>ISO-8601 year number. This has the same value as <em>Y</em>, except that if the ISO week number (<em>W</em>) belongs to the previous or next year, that year is used instead. (added in PHP 5.1.0)</p>
</blockquote>

<p>自己測試的結果：</p>

<pre><code class="language-php">// 2015
echo date('o');

// 2014
echo date('Y');
</code></pre>

<p>然後，從今早的傳言看來，Twitter 的 OAuth server 出的包可能就是因為這個……（原文已刪，連結是 <a href="https://www.facebook.com/thehackernews/posts/1051721444841728）">https://www.facebook.com/thehackernews/posts/1051721444841728）</a></p>

<h2 id="2014-12-31-edit">2014-12-31 edit</h2>

<p>從 <a href="https://news.ycombinator.com/item?id=8810157">Hacker News</a> 的消息看來，Twitter 掛站確定是這個原因了：</p>

<blockquote>
<p>If you&rsquo;re using YYYY in your JVM service or %G in anything, fix it now</p>

<p>The single character G instead of Y took down Twitter&rsquo;s API today.
If you&rsquo;re using YYYY in your JVM service or %G in anything, fix it now. You&rsquo;re very likely using the wrong year format.</p>

<p>date
Mon Dec 29 00:44:45 EST 2014</p>

<p>date -u &ldquo;+%G&rdquo;
2015</p>

<p>ISO 8601 week numbering has 2015 start this week.</p>
</blockquote>

<p>自己在 Bash 裡下指令的結果：</p>

<pre><code class="language-bash">$ date +%Y
2014

$ date +%G
2015

$ date --help
%Y   year
%G   year of ISO week number (see %V); normally useful only with %V
%V   ISO week number, with Monday as first day of week (01..53)
</code></pre>

</main>

    <footer>
      
<script>
(function() {
  function center_el(tagName) {
    var tags = document.getElementsByTagName(tagName), i, tag;
    for (i = 0; i < tags.length; i++) {
      tag = tags[i];
      var parent = tag.parentElement;
      
      if (parent.childNodes.length === 1) {
        
        if (parent.nodeName === 'A') {
          parent = parent.parentElement;
          if (parent.childNodes.length != 1) continue;
        }
        if (parent.nodeName === 'P') parent.style.textAlign = 'center';
      }
    }
  }
  var tagNames = ['img', 'embed', 'object'];
  for (var i = 0; i < tagNames.length; i++) {
    center_el(tagNames[i]);
  }
})();
</script>

      
      <hr/>
      Created with <a href="https://gohugo.io/">Hugo</a> and <a href="https://themes.gohugo.io/hugo-classic/">Hugo-Classic</a>
      
    </footer>
  </body>
</html>

